let E=[],F=0;const fe=4;let Xt=e=>{let t=[],r={get(){return r.lc||r.listen(()=>{})(),r.value},lc:0,listen(n){return r.lc=t.push(n),()=>{for(let i=F+fe;i<E.length;)E[i]===n?E.splice(i,fe):i+=fe;let s=t.indexOf(n);~s&&(t.splice(s,1),--r.lc||r.off())}},notify(n,s){let i=!E.length;for(let o of t)E.push(o,r.value,n,s);if(i){for(F=0;F<E.length;F+=fe)E[F](E[F+1],E[F+2],E[F+3]);E.length=0}},off(){},set(n){let s=r.value;s!==n&&(r.value=n,r.notify(s))},subscribe(n){let s=r.listen(n);return n(r.value),s},value:e};return r};function Yt(e,t){let r=gt(t),n=e;for(let s of r){if(n===void 0)break;n=n[s]}return n}function er(e,t,r){return dt(e??{},gt(t),r)}function dt(e,t,r){let n=t[0],s=Array.isArray(e)?[...e]:{...e};return t.length===1?(r===void 0?Array.isArray(s)?s.splice(n,1):delete s[n]:s[n]=r,s):(rr(s,n,t[1]),s[n]=dt(s[n],t.slice(1),r),s)}const Ve=/(.*)\[(\d+)\]/;function gt(e){return e.split(".").flatMap(t=>ht(t))}function ht(e){if(Ve.test(e)){let[,t,r]=e.match(Ve);return[...ht(t),r]}return[e]}const tr=/^\d+$/;function rr(e,t,r){if(t in e)return;tr.test(r)?e[t]=Array(parseInt(r,10)+1):e[t]={}}function nr(e={}){let t=Xt(e);return t.setKey=(r,n)=>{if(Yt(t.value,r)!==n){let s=t.value;t.value=er(t.value,r,n),t.notify(s,r)}},t}/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function Ue(e){return Object.prototype.toString.call(e)==="[object Object]"}function w(e){var t,r;return Ue(e)===!1?!1:(t=e.constructor,t===void 0?!0:(r=t.prototype,!(Ue(r)===!1||r.hasOwnProperty("isPrototypeOf")===!1)))}var mt=Symbol.for("immer-nothing"),Je=Symbol.for("immer-draftable"),x=Symbol.for("immer-state");function j(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Z=Object.getPrototypeOf;function $(e){return!!e&&!!e[x]}function K(e){return e?vt(e)||Array.isArray(e)||!!e[Je]||!!e.constructor?.[Je]||he(e)||me(e):!1}var sr=Object.prototype.constructor.toString();function vt(e){if(!e||typeof e!="object")return!1;const t=Z(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===sr}function ue(e,t){ge(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function ge(e){const t=e[x];return t?t.type_:Array.isArray(e)?1:he(e)?2:me(e)?3:0}function Se(e,t){return ge(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function yt(e,t,r){const n=ge(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function ir(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function he(e){return e instanceof Map}function me(e){return e instanceof Set}function q(e){return e.copy_||e.base_}function Ee(e,t){if(he(e))return new Map(e);if(me(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=vt(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[x];let s=Reflect.ownKeys(n);for(let i=0;i<s.length;i++){const o=s[i],a=n[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(n[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[o]})}return Object.create(Z(e),n)}else{const n=Z(e);if(n!==null&&r)return{...e};const s=Object.create(n);return Object.assign(s,e)}}function De(e,t=!1){return ve(e)||$(e)||!K(e)||(ge(e)>1&&(e.set=e.add=e.clear=e.delete=ar),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>De(n,!0))),e}function ar(){j(2)}function ve(e){return Object.isFrozen(e)}var or={};function I(e){const t=or[e];return t||j(0,e),t}var ne;function pt(){return ne}function fr(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Qe(e,t){t&&(I("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function je(e){ke(e),e.drafts_.forEach(cr),e.drafts_=null}function ke(e){e===ne&&(ne=e.parent_)}function Ze(e){return ne=fr(ne,e)}function cr(e){const t=e[x];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function He(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[x].modified_&&(je(t),j(4)),K(e)&&(e=le(t,e),t.parent_||de(t,e)),t.patches_&&I("Patches").generateReplacementPatches_(r[x].base_,e,t.patches_,t.inversePatches_)):e=le(t,r,[]),je(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==mt?e:void 0}function le(e,t,r){if(ve(t))return t;const n=t[x];if(!n)return ue(t,(s,i)=>Ge(e,n,t,s,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return de(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const s=n.copy_;let i=s,o=!1;n.type_===3&&(i=new Set(s),s.clear(),o=!0),ue(i,(a,c)=>Ge(e,n,s,a,c,r,o)),de(e,s,!1),r&&e.patches_&&I("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function Ge(e,t,r,n,s,i,o){if($(s)){const a=i&&t&&t.type_!==3&&!Se(t.assigned_,n)?i.concat(n):void 0,c=le(e,s,a);if(yt(r,n,c),$(c))e.canAutoFreeze_=!1;else return}else o&&r.add(s);if(K(s)&&!ve(s)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;le(e,s),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&de(e,s)}}function de(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&De(t,r)}function ur(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:pt(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=n,i=Fe;r&&(s=[n],i=se);const{revoke:o,proxy:a}=Proxy.revocable(s,i);return n.draft_=a,n.revoke_=o,a}var Fe={get(e,t){if(t===x)return e;const r=q(e);if(!Se(r,t))return lr(e,r,t);const n=r[t];return e.finalized_||!K(n)?n:n===xe(e.base_,t)?(Ae(e),e.copy_[t]=Re(n,e)):n},has(e,t){return t in q(e)},ownKeys(e){return Reflect.ownKeys(q(e))},set(e,t,r){const n=bt(q(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const s=xe(q(e),t),i=s?.[x];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(ir(r,s)&&(r!==void 0||Se(e.base_,t)))return!0;Ae(e),Ne(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return xe(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Ae(e),Ne(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=q(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){j(11)},getPrototypeOf(e){return Z(e.base_)},setPrototypeOf(){j(12)}},se={};ue(Fe,(e,t)=>{se[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});se.deleteProperty=function(e,t){return se.set.call(this,e,t,void 0)};se.set=function(e,t,r){return Fe.set.call(this,e[0],t,r,e[0])};function xe(e,t){const r=e[x];return(r?q(r):e)[t]}function lr(e,t,r){const n=bt(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function bt(e,t){if(!(t in e))return;let r=Z(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Z(r)}}function Ne(e){e.modified_||(e.modified_=!0,e.parent_&&Ne(e.parent_))}function Ae(e){e.copy_||(e.copy_=Ee(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var dr=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const o=this;return function(c=i,...l){return o.produce(c,h=>r.call(this,h,...l))}}typeof r!="function"&&j(6),n!==void 0&&typeof n!="function"&&j(7);let s;if(K(t)){const i=Ze(this),o=Re(t,void 0);let a=!0;try{s=r(o),a=!1}finally{a?je(i):ke(i)}return Qe(i,n),He(s,i)}else if(!t||typeof t!="object"){if(s=r(t),s===void 0&&(s=t),s===mt&&(s=void 0),this.autoFreeze_&&De(s,!0),n){const i=[],o=[];I("Patches").generateReplacementPatches_(t,s,i,o),n(i,o)}return s}else j(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(o,...a)=>this.produceWithPatches(o,c=>t(c,...a));let n,s;return[this.produce(t,r,(o,a)=>{n=o,s=a}),n,s]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){K(e)||j(8),$(e)&&(e=gr(e));const t=Ze(this),r=Re(e,void 0);return r[x].isManual_=!0,ke(t),r}finishDraft(e,t){const r=e&&e[x];(!r||!r.isManual_)&&j(9);const{scope_:n}=r;return Qe(n,t),He(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const s=t[r];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}r>-1&&(t=t.slice(r+1));const n=I("Patches").applyPatches_;return $(e)?n(e,t):this.produce(e,s=>n(s,t))}};function Re(e,t){const r=he(e)?I("MapSet").proxyMap_(e,t):me(e)?I("MapSet").proxySet_(e,t):ur(e,t);return(t?t.scope_:pt()).drafts_.push(r),r}function gr(e){return $(e)||j(10,e),wt(e)}function wt(e){if(!K(e)||ve(e))return e;const t=e[x];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Ee(e,t.scope_.immer_.useStrictShallowCopy_)}else r=Ee(e,!0);return ue(r,(n,s)=>{yt(r,n,wt(s))}),t&&(t.finalized_=!1),r}var A=new dr,Te=A.produce;A.produceWithPatches.bind(A);A.setAutoFreeze.bind(A);A.setUseStrictShallowCopy.bind(A);A.applyPatches.bind(A);var Xe=A.createDraft.bind(A),Ye=A.finishDraft.bind(A),f={ancestors(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{reverse:r=!1}=t,n=f.levels(e,t);return r?n=n.slice(1):n=n.slice(0,-1),n},common(e,t){for(var r=[],n=0;n<e.length&&n<t.length;n++){var s=e[n],i=t[n];if(s!==i)break;r.push(s)}return r},compare(e,t){for(var r=Math.min(e.length,t.length),n=0;n<r;n++){if(e[n]<t[n])return-1;if(e[n]>t[n])return 1}return 0},endsAfter(e,t){var r=e.length-1,n=e.slice(0,r),s=t.slice(0,r),i=e[r],o=t[r];return f.equals(n,s)&&i>o},endsAt(e,t){var r=e.length,n=e.slice(0,r),s=t.slice(0,r);return f.equals(n,s)},endsBefore(e,t){var r=e.length-1,n=e.slice(0,r),s=t.slice(0,r),i=e[r],o=t[r];return f.equals(n,s)&&i<o},equals(e,t){return e.length===t.length&&e.every((r,n)=>r===t[n])},hasPrevious(e){return e[e.length-1]>0},isAfter(e,t){return f.compare(e,t)===1},isAncestor(e,t){return e.length<t.length&&f.compare(e,t)===0},isBefore(e,t){return f.compare(e,t)===-1},isChild(e,t){return e.length===t.length+1&&f.compare(e,t)===0},isCommon(e,t){return e.length<=t.length&&f.compare(e,t)===0},isDescendant(e,t){return e.length>t.length&&f.compare(e,t)===0},isParent(e,t){return e.length+1===t.length&&f.compare(e,t)===0},isPath(e){return Array.isArray(e)&&(e.length===0||typeof e[0]=="number")},isSibling(e,t){if(e.length!==t.length)return!1;var r=e.slice(0,-1),n=t.slice(0,-1),s=e[e.length-1],i=t[t.length-1];return s!==i&&f.equals(r,n)},levels(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{reverse:r=!1}=t,n=[],s=0;s<=e.length;s++)n.push(e.slice(0,s));return r&&n.reverse(),n},next(e){if(e.length===0)throw new Error("Cannot get the next path of a root path [".concat(e,"], because it has no next index."));var t=e[e.length-1];return e.slice(0,-1).concat(t+1)},operationCanTransformPath(e){switch(e.type){case"insert_node":case"remove_node":case"merge_node":case"split_node":case"move_node":return!0;default:return!1}},parent(e){if(e.length===0)throw new Error("Cannot get the parent path of the root path [".concat(e,"]."));return e.slice(0,-1)},previous(e){if(e.length===0)throw new Error("Cannot get the previous path of a root path [".concat(e,"], because it has no previous index."));var t=e[e.length-1];if(t<=0)throw new Error("Cannot get the previous path of a first child path [".concat(e,"] because it would result in a negative index."));return e.slice(0,-1).concat(t-1)},relative(e,t){if(!f.isAncestor(t,e)&&!f.equals(e,t))throw new Error("Cannot get the relative path of [".concat(e,"] inside ancestor [").concat(t,"], because it is not above or equal to the path."));return e.slice(t.length)},transform(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return null;var n=[...e],{affinity:s="forward"}=r;if(e.length===0)return n;switch(t.type){case"insert_node":{var{path:i}=t;(f.equals(i,n)||f.endsBefore(i,n)||f.isAncestor(i,n))&&(n[i.length-1]+=1);break}case"remove_node":{var{path:o}=t;if(f.equals(o,n)||f.isAncestor(o,n))return null;f.endsBefore(o,n)&&(n[o.length-1]-=1);break}case"merge_node":{var{path:a,position:c}=t;f.equals(a,n)||f.endsBefore(a,n)?n[a.length-1]-=1:f.isAncestor(a,n)&&(n[a.length-1]-=1,n[a.length]+=c);break}case"split_node":{var{path:l,position:h}=t;if(f.equals(l,n)){if(s==="forward")n[n.length-1]+=1;else if(s!=="backward")return null}else f.endsBefore(l,n)?n[l.length-1]+=1:f.isAncestor(l,n)&&e[l.length]>=h&&(n[l.length-1]+=1,n[l.length]-=h);break}case"move_node":{var{path:g,newPath:p}=t;if(f.equals(g,p))return n;if(f.isAncestor(g,n)||f.equals(g,n)){var O=p.slice();return f.endsBefore(g,p)&&g.length<p.length&&(O[g.length-1]-=1),O.concat(n.slice(g.length))}else f.isSibling(g,p)&&(f.isAncestor(p,n)||f.equals(p,n))?f.endsBefore(g,n)?n[g.length-1]-=1:n[g.length-1]+=1:f.endsBefore(p,n)||f.equals(p,n)||f.isAncestor(p,n)?(f.endsBefore(g,n)&&(n[g.length-1]-=1),n[p.length-1]+=1):f.endsBefore(g,n)&&(f.equals(p,n)&&(n[p.length-1]+=1),n[g.length-1]-=1);break}}return n}};function ie(e){"@babel/helpers - typeof";return ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ie(e)}function hr(e,t){if(ie(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ie(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mr(e){var t=hr(e,"string");return ie(t)==="symbol"?t:String(t)}function H(e,t,r){return t=mr(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function et(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?et(Object(r),!0).forEach(function(n){H(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):et(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var vr=(e,t,r)=>{switch(r.type){case"insert_node":{var{path:n,node:s}=r,i=u.parent(e,n),o=n[n.length-1];if(o>i.children.length)throw new Error('Cannot apply an "insert_node" operation at path ['.concat(n,"] because the destination is past the end of the node."));if(i.children.splice(o,0,s),t)for(var[a,c]of d.points(t))t[c]=v.transform(a,r);break}case"insert_text":{var{path:l,offset:h,text:g}=r;if(g.length===0)break;var p=u.leaf(e,l),O=p.text.slice(0,h),P=p.text.slice(h);if(p.text=O+g+P,t)for(var[G,X]of d.points(t))t[X]=v.transform(G,r);break}case"merge_node":{var{path:N}=r,D=u.get(e,N),_t=f.previous(N),Y=u.get(e,_t),xt=u.parent(e,N),At=N[N.length-1];if(b.isText(D)&&b.isText(Y))Y.text+=D.text;else if(!b.isText(D)&&!b.isText(Y))Y.children.push(...D.children);else throw new Error('Cannot apply a "merge_node" operation at path ['.concat(N,"] to nodes of different interfaces: ").concat(k.stringify(D)," ").concat(k.stringify(Y)));if(xt.children.splice(At,1),t)for(var[St,Et]of d.points(t))t[Et]=v.transform(St,r);break}case"move_node":{var{path:T,newPath:Ce}=r;if(f.isAncestor(T,Ce))throw new Error("Cannot move a path [".concat(T,"] to new path [").concat(Ce,"] because the destination is inside itself."));var jt=u.get(e,T),kt=u.parent(e,T),Nt=T[T.length-1];kt.children.splice(Nt,1);var ye=f.transform(T,r),Rt=u.get(e,f.parent(ye)),Dt=ye[ye.length-1];if(Rt.children.splice(Dt,0,jt),t)for(var[Ft,Tt]of d.points(t))t[Tt]=v.transform(Ft,r);break}case"remove_node":{var{path:C}=r,Ct=C[C.length-1],zt=u.parent(e,C);if(zt.children.splice(Ct,1),t)for(var[ee,Lt]of d.points(t)){var ze=v.transform(ee,r);if(t!=null&&ze!=null)t[Lt]=ze;else{var V=void 0,z=void 0;for(var[Le,pe]of u.texts(e))if(f.compare(pe,C)===-1)V=[Le,pe];else{z=[Le,pe];break}var be=!1;V&&z&&(f.equals(z[1],C)?be=!f.hasPrevious(z[1]):be=f.common(V[1],C).length<f.common(z[1],C).length),V&&!be?(ee.path=V[1],ee.offset=V[0].text.length):z?(ee.path=z[1],ee.offset=0):t=null}}break}case"remove_text":{var{path:Bt,offset:Be,text:qe}=r;if(qe.length===0)break;var we=u.leaf(e,Bt),qt=we.text.slice(0,Be),Mt=we.text.slice(Be+qe.length);if(we.text=qt+Mt,t)for(var[$t,Kt]of d.points(t))t[Kt]=v.transform($t,r);break}case"set_node":{var{path:Me,properties:It,newProperties:Oe}=r;if(Me.length===0)throw new Error("Cannot set properties on the root node!");var Pe=u.get(e,Me);for(var U in Oe){if(U==="children"||U==="text")throw new Error('Cannot set the "'.concat(U,'" property of nodes!'));var $e=Oe[U];$e==null?delete Pe[U]:Pe[U]=$e}for(var Ke in It)Oe.hasOwnProperty(Ke)||delete Pe[Ke];break}case"set_selection":{var{newProperties:L}=r;if(L==null)t=L;else{if(t==null){if(!d.isRange(L))throw new Error('Cannot apply an incomplete "set_selection" operation properties '.concat(k.stringify(L)," when there is no current selection."));t=te({},L)}for(var J in L){var Ie=L[J];if(Ie==null){if(J==="anchor"||J==="focus")throw new Error('Cannot remove the "'.concat(J,'" selection property'));delete t[J]}else t[J]=Ie}}break}case"split_node":{var{path:Q,position:oe,properties:We}=r;if(Q.length===0)throw new Error('Cannot apply a "split_node" operation at path ['.concat(Q,"] because the root node cannot be split."));var B=u.get(e,Q),Wt=u.parent(e,Q),Vt=Q[Q.length-1],_e;if(b.isText(B)){var Ut=B.text.slice(0,oe),Jt=B.text.slice(oe);B.text=Ut,_e=te(te({},We),{},{text:Jt})}else{var Qt=B.children.slice(0,oe),Zt=B.children.slice(oe);B.children=Qt,_e=te(te({},We),{},{children:Zt})}if(Wt.children.splice(Vt+1,0,_e),t)for(var[Ht,Gt]of d.points(t))t[Gt]=v.transform(Ht,r);break}}return t},yr={transform(e,t){e.children=Xe(e.children);var r=e.selection&&Xe(e.selection);try{r=vr(e,r,t)}finally{e.children=Ye(e.children),r?e.selection=$(r)?Ye(r):r:e.selection=null}}},pr={insertNodes(e,t,r){e.insertNodes(t,r)},liftNodes(e,t){e.liftNodes(t)},mergeNodes(e,t){e.mergeNodes(t)},moveNodes(e,t){e.moveNodes(t)},removeNodes(e,t){e.removeNodes(t)},setNodes(e,t,r){e.setNodes(t,r)},splitNodes(e,t){e.splitNodes(t)},unsetNodes(e,t,r){e.unsetNodes(t,r)},unwrapNodes(e,t){e.unwrapNodes(t)},wrapNodes(e,t,r){e.wrapNodes(t,r)}},br={collapse(e,t){e.collapse(t)},deselect(e){e.deselect()},move(e,t){e.move(t)},select(e,t){e.select(t)},setPoint(e,t,r){e.setPoint(t,r)},setSelection(e,t){e.setSelection(t)}},Ot=(e,t)=>{for(var r in e){var n=e[r],s=t[r];if(w(n)&&w(s)){if(!Ot(n,s))return!1}else if(Array.isArray(n)&&Array.isArray(s)){if(n.length!==s.length)return!1;for(var i=0;i<n.length;i++)if(n[i]!==s[i])return!1}else if(n!==s)return!1}for(var o in t)if(e[o]===void 0&&t[o]!==void 0)return!1;return!0};function wr(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function ae(e,t){if(e==null)return{};var r=wr(e,t),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var Or=["anchor","focus"];function tt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Pr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tt(Object(r),!0).forEach(function(n){H(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tt(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var d={edges(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{reverse:r=!1}=t,{anchor:n,focus:s}=e;return d.isBackward(e)===r?[n,s]:[s,n]},end(e){var[,t]=d.edges(e);return t},equals(e,t){return v.equals(e.anchor,t.anchor)&&v.equals(e.focus,t.focus)},includes(e,t){if(d.isRange(t)){if(d.includes(e,t.anchor)||d.includes(e,t.focus))return!0;var[r,n]=d.edges(e),[s,i]=d.edges(t);return v.isBefore(r,s)&&v.isAfter(n,i)}var[o,a]=d.edges(e),c=!1,l=!1;return v.isPoint(t)?(c=v.compare(t,o)>=0,l=v.compare(t,a)<=0):(c=f.compare(t,o.path)>=0,l=f.compare(t,a.path)<=0),c&&l},intersection(e,t){var r=ae(e,Or),[n,s]=d.edges(e),[i,o]=d.edges(t),a=v.isBefore(n,i)?i:n,c=v.isBefore(s,o)?s:o;return v.isBefore(c,a)?null:Pr({anchor:a,focus:c},r)},isBackward(e){var{anchor:t,focus:r}=e;return v.isAfter(t,r)},isCollapsed(e){var{anchor:t,focus:r}=e;return v.equals(t,r)},isExpanded(e){return!d.isCollapsed(e)},isForward(e){return!d.isBackward(e)},isRange(e){return w(e)&&v.isPoint(e.anchor)&&v.isPoint(e.focus)},*points(e){yield[e.anchor,"anchor"],yield[e.focus,"focus"]},start(e){var[t]=d.edges(e);return t},transform(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Te(e,n=>{if(n===null)return null;var{affinity:s="inward"}=r,i,o;if(s==="inward"){var a=d.isCollapsed(n);d.isForward(n)?(i="forward",o=a?i:"backward"):(i="backward",o=a?i:"forward")}else s==="outward"?d.isForward(n)?(i="backward",o="forward"):(i="forward",o="backward"):(i=s,o=s);var c=v.transform(n.anchor,t,{affinity:i}),l=v.transform(n.focus,t,{affinity:o});if(!c||!l)return null;n.anchor=c,n.focus=l})}},rt=e=>w(e)&&u.isNodeList(e.children)&&!S.isEditor(e),M={isAncestor(e){return w(e)&&u.isNodeList(e.children)},isElement:rt,isElementList(e){return Array.isArray(e)&&e.every(t=>M.isElement(t))},isElementProps(e){return e.children!==void 0},isElementType:function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"type";return rt(t)&&t[n]===r},matches(e,t){for(var r in t)if(r!=="children"&&e[r]!==t[r])return!1;return!0}},_r=["children"],xr=["text"],nt=new WeakMap,u={ancestor(e,t){var r=u.get(e,t);if(b.isText(r))throw new Error("Cannot get the ancestor node at path [".concat(t,"] because it refers to a text node instead: ").concat(k.stringify(r)));return r},ancestors(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){for(var n of f.ancestors(t,r)){var s=u.ancestor(e,n),i=[s,n];yield i}}()},child(e,t){if(b.isText(e))throw new Error("Cannot get the child of a text node: ".concat(k.stringify(e)));var r=e.children[t];if(r==null)throw new Error("Cannot get child at index `".concat(t,"` in node: ").concat(k.stringify(e)));return r},children(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){for(var{reverse:n=!1}=r,s=u.ancestor(e,t),{children:i}=s,o=n?i.length-1:0;n?o>=0:o<i.length;){var a=u.child(s,o),c=t.concat(o);yield[a,c],o=n?o-1:o+1}}()},common(e,t,r){var n=f.common(t,r),s=u.get(e,n);return[s,n]},descendant(e,t){var r=u.get(e,t);if(S.isEditor(r))throw new Error("Cannot get the descendant node at path [".concat(t,"] because it refers to the root editor node instead: ").concat(k.stringify(r)));return r},descendants(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){for(var[r,n]of u.nodes(e,t))n.length!==0&&(yield[r,n])}()},elements(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){for(var[r,n]of u.nodes(e,t))M.isElement(r)&&(yield[r,n])}()},extractProps(e){if(M.isAncestor(e)){var t=ae(e,_r);return t}else{var t=ae(e,xr);return t}},first(e,t){for(var r=t.slice(),n=u.get(e,r);n&&!(b.isText(n)||n.children.length===0);)n=n.children[0],r.push(0);return[n,r]},fragment(e,t){if(b.isText(e))throw new Error("Cannot get a fragment starting from a root text node: ".concat(k.stringify(e)));var r=Te({children:e.children},n=>{var[s,i]=d.edges(t),o=u.nodes(n,{reverse:!0,pass:p=>{var[,O]=p;return!d.includes(t,O)}});for(var[,a]of o){if(!d.includes(t,a)){var c=u.parent(n,a),l=a[a.length-1];c.children.splice(l,1)}if(f.equals(a,i.path)){var h=u.leaf(n,a);h.text=h.text.slice(0,i.offset)}if(f.equals(a,s.path)){var g=u.leaf(n,a);g.text=g.text.slice(s.offset)}}S.isEditor(n)&&(n.selection=null)});return r.children},get(e,t){for(var r=e,n=0;n<t.length;n++){var s=t[n];if(b.isText(r)||!r.children[s])throw new Error("Cannot find a descendant at path [".concat(t,"] in node: ").concat(k.stringify(e)));r=r.children[s]}return r},has(e,t){for(var r=e,n=0;n<t.length;n++){var s=t[n];if(b.isText(r)||!r.children[s])return!1;r=r.children[s]}return!0},isNode(e){return b.isText(e)||M.isElement(e)||S.isEditor(e)},isNodeList(e){if(!Array.isArray(e))return!1;var t=nt.get(e);if(t!==void 0)return t;var r=e.every(n=>u.isNode(n));return nt.set(e,r),r},last(e,t){for(var r=t.slice(),n=u.get(e,r);n&&!(b.isText(n)||n.children.length===0);){var s=n.children.length-1;n=n.children[s],r.push(s)}return[n,r]},leaf(e,t){var r=u.get(e,t);if(!b.isText(r))throw new Error("Cannot get the leaf node at path [".concat(t,"] because it refers to a non-leaf node: ").concat(k.stringify(r)));return r},levels(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){for(var n of f.levels(t,r)){var s=u.get(e,n);yield[s,n]}}()},matches(e,t){return M.isElement(e)&&M.isElementProps(t)&&M.matches(e,t)||b.isText(e)&&b.isTextProps(t)&&b.matches(e,t)},nodes(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){for(var{pass:r,reverse:n=!1}=t,{from:s=[],to:i}=t,o=new Set,a=[],c=e;!(i&&(n?f.isBefore(a,i):f.isAfter(a,i)));){if(o.has(c)||(yield[c,a]),!o.has(c)&&!b.isText(c)&&c.children.length!==0&&(r==null||r([c,a])===!1)){o.add(c);var l=n?c.children.length-1:0;f.isAncestor(a,s)&&(l=s[a.length]),a=a.concat(l),c=u.get(e,a);continue}if(a.length===0)break;if(!n){var h=f.next(a);if(u.has(e,h)){a=h,c=u.get(e,a);continue}}if(n&&a[a.length-1]!==0){var g=f.previous(a);a=g,c=u.get(e,a);continue}a=f.parent(a),c=u.get(e,a),o.add(c)}}()},parent(e,t){var r=f.parent(t),n=u.get(e,r);if(b.isText(n))throw new Error("Cannot get the parent of path [".concat(t,"] because it does not exist in the root."));return n},string(e){return b.isText(e)?e.text:e.children.map(u.string).join("")},texts(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){for(var[r,n]of u.nodes(e,t))b.isText(r)&&(yield[r,n])}()}};function st(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?st(Object(r),!0).forEach(function(n){H(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):st(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var re={isNodeOperation(e){return re.isOperation(e)&&e.type.endsWith("_node")},isOperation(e){if(!w(e))return!1;switch(e.type){case"insert_node":return f.isPath(e.path)&&u.isNode(e.node);case"insert_text":return typeof e.offset=="number"&&typeof e.text=="string"&&f.isPath(e.path);case"merge_node":return typeof e.position=="number"&&f.isPath(e.path)&&w(e.properties);case"move_node":return f.isPath(e.path)&&f.isPath(e.newPath);case"remove_node":return f.isPath(e.path)&&u.isNode(e.node);case"remove_text":return typeof e.offset=="number"&&typeof e.text=="string"&&f.isPath(e.path);case"set_node":return f.isPath(e.path)&&w(e.properties)&&w(e.newProperties);case"set_selection":return e.properties===null&&d.isRange(e.newProperties)||e.newProperties===null&&d.isRange(e.properties)||w(e.properties)&&w(e.newProperties);case"split_node":return f.isPath(e.path)&&typeof e.position=="number"&&w(e.properties);default:return!1}},isOperationList(e){return Array.isArray(e)&&e.every(t=>re.isOperation(t))},isSelectionOperation(e){return re.isOperation(e)&&e.type.endsWith("_selection")},isTextOperation(e){return re.isOperation(e)&&e.type.endsWith("_text")},inverse(e){switch(e.type){case"insert_node":return y(y({},e),{},{type:"remove_node"});case"insert_text":return y(y({},e),{},{type:"remove_text"});case"merge_node":return y(y({},e),{},{type:"split_node",path:f.previous(e.path)});case"move_node":{var{newPath:t,path:r}=e;if(f.equals(t,r))return e;if(f.isSibling(r,t))return y(y({},e),{},{path:t,newPath:r});var n=f.transform(r,e),s=f.transform(f.next(r),e);return y(y({},e),{},{path:n,newPath:s})}case"remove_node":return y(y({},e),{},{type:"insert_node"});case"remove_text":return y(y({},e),{},{type:"insert_text"});case"set_node":{var{properties:i,newProperties:o}=e;return y(y({},e),{},{properties:o,newProperties:i})}case"set_selection":{var{properties:a,newProperties:c}=e;return a==null?y(y({},e),{},{properties:c,newProperties:null}):c==null?y(y({},e),{},{properties:null,newProperties:a}):y(y({},e),{},{properties:c,newProperties:a})}case"split_node":return y(y({},e),{},{type:"merge_node",path:f.next(e.path)})}}},it=new WeakMap,Ar=e=>{var t=it.get(e);if(t!==void 0)return t;if(!w(e))return!1;var r=typeof e.addMark=="function"&&typeof e.apply=="function"&&typeof e.deleteFragment=="function"&&typeof e.insertBreak=="function"&&typeof e.insertSoftBreak=="function"&&typeof e.insertFragment=="function"&&typeof e.insertNode=="function"&&typeof e.insertText=="function"&&typeof e.isElementReadOnly=="function"&&typeof e.isInline=="function"&&typeof e.isSelectable=="function"&&typeof e.isVoid=="function"&&typeof e.normalizeNode=="function"&&typeof e.onChange=="function"&&typeof e.removeMark=="function"&&typeof e.getDirtyPaths=="function"&&(e.marks===null||w(e.marks))&&(e.selection===null||d.isRange(e.selection))&&u.isNodeList(e.children)&&re.isOperationList(e.operations);return it.set(e,r),r},S={above(e,t){return e.above(t)},addMark(e,t,r){e.addMark(t,r)},after(e,t,r){return e.after(t,r)},before(e,t,r){return e.before(t,r)},deleteBackward(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{unit:r="character"}=t;e.deleteBackward(r)},deleteForward(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{unit:r="character"}=t;e.deleteForward(r)},deleteFragment(e,t){e.deleteFragment(t)},edges(e,t){return e.edges(t)},elementReadOnly(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.elementReadOnly(t)},end(e,t){return e.end(t)},first(e,t){return e.first(t)},fragment(e,t){return e.fragment(t)},hasBlocks(e,t){return e.hasBlocks(t)},hasInlines(e,t){return e.hasInlines(t)},hasPath(e,t){return e.hasPath(t)},hasTexts(e,t){return e.hasTexts(t)},insertBreak(e){e.insertBreak()},insertFragment(e,t,r){e.insertFragment(t,r)},insertNode(e,t){e.insertNode(t)},insertSoftBreak(e){e.insertSoftBreak()},insertText(e,t){e.insertText(t)},isBlock(e,t){return e.isBlock(t)},isEdge(e,t,r){return e.isEdge(t,r)},isEditor(e){return Ar(e)},isElementReadOnly(e,t){return e.isElementReadOnly(t)},isEmpty(e,t){return e.isEmpty(t)},isEnd(e,t,r){return e.isEnd(t,r)},isInline(e,t){return e.isInline(t)},isNormalizing(e){return e.isNormalizing()},isSelectable(e,t){return e.isSelectable(t)},isStart(e,t,r){return e.isStart(t,r)},isVoid(e,t){return e.isVoid(t)},last(e,t){return e.last(t)},leaf(e,t,r){return e.leaf(t,r)},levels(e,t){return e.levels(t)},marks(e){return e.getMarks()},next(e,t){return e.next(t)},node(e,t,r){return e.node(t,r)},nodes(e,t){return e.nodes(t)},normalize(e,t){e.normalize(t)},parent(e,t,r){return e.parent(t,r)},path(e,t,r){return e.path(t,r)},pathRef(e,t,r){return e.pathRef(t,r)},pathRefs(e){return e.pathRefs()},point(e,t,r){return e.point(t,r)},pointRef(e,t,r){return e.pointRef(t,r)},pointRefs(e){return e.pointRefs()},positions(e,t){return e.positions(t)},previous(e,t){return e.previous(t)},range(e,t,r){return e.range(t,r)},rangeRef(e,t,r){return e.rangeRef(t,r)},rangeRefs(e){return e.rangeRefs()},removeMark(e,t){e.removeMark(t)},setNormalizing(e,t){e.setNormalizing(t)},start(e,t){return e.start(t)},string(e,t,r){return e.string(t,r)},unhangRange(e,t,r){return e.unhangRange(t,r)},void(e,t){return e.void(t)},withoutNormalizing(e,t){e.withoutNormalizing(t)},shouldMergeNodesRemovePrevNode:(e,t,r)=>e.shouldMergeNodesRemovePrevNode(t,r)};function at(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function ot(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?at(Object(r),!0).forEach(function(n){H(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):at(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var v={compare(e,t){var r=f.compare(e.path,t.path);return r===0?e.offset<t.offset?-1:e.offset>t.offset?1:0:r},isAfter(e,t){return v.compare(e,t)===1},isBefore(e,t){return v.compare(e,t)===-1},equals(e,t){return e.offset===t.offset&&f.equals(e.path,t.path)},isPoint(e){return w(e)&&typeof e.offset=="number"&&f.isPath(e.path)},transform(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Te(e,n=>{if(n===null)return null;var{affinity:s="forward"}=r,{path:i,offset:o}=n;switch(t.type){case"insert_node":case"move_node":{n.path=f.transform(i,t,r);break}case"insert_text":{f.equals(t.path,i)&&(t.offset<o||t.offset===o&&s==="forward")&&(n.offset+=t.text.length);break}case"merge_node":{f.equals(t.path,i)&&(n.offset+=t.position),n.path=f.transform(i,t,r);break}case"remove_text":{f.equals(t.path,i)&&t.offset<=o&&(n.offset-=Math.min(o-t.offset,t.text.length));break}case"remove_node":{if(f.equals(t.path,i)||f.isAncestor(t.path,i))return null;n.path=f.transform(i,t,r);break}case"split_node":{if(f.equals(t.path,i)){if(t.position===o&&s==null)return null;(t.position<o||t.position===o&&s==="forward")&&(n.offset-=t.position,n.path=f.transform(i,t,ot(ot({},r),{},{affinity:"forward"})))}else n.path=f.transform(i,t,r);break}}})}},ft=void 0,k={setScrubber(e){ft=e},stringify(e){return JSON.stringify(e,ft)}},Sr=["text"],Er=["anchor","focus"];function ct(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ct(Object(r),!0).forEach(function(n){H(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ct(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var b={equals(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},{loose:n=!1}=r;function s(i){var o=ae(i,Sr);return o}return Ot(n?s(e):e,n?s(t):t)},isText(e){return w(e)&&typeof e.text=="string"},isTextList(e){return Array.isArray(e)&&e.every(t=>b.isText(t))},isTextProps(e){return e.text!==void 0},matches(e,t){for(var r in t)if(r!=="text"&&(!e.hasOwnProperty(r)||e[r]!==t[r]))return!1;return!0},decorations(e,t){var r=[R({},e)];for(var n of t){var s=ae(n,Er),[i,o]=d.edges(n),a=[],c=0,l=i.offset,h=o.offset;for(var g of r){var{length:p}=g.text,O=c;if(c+=p,l<=O&&c<=h){Object.assign(g,s),a.push(g);continue}if(l!==h&&(l===c||h===O)||l>c||h<O||h===O&&O!==0){a.push(g);continue}var P=g,G=void 0,X=void 0;if(h<c){var N=h-O;X=R(R({},P),{},{text:P.text.slice(N)}),P=R(R({},P),{},{text:P.text.slice(0,N)})}if(l>O){var D=l-O;G=R(R({},P),{},{text:P.text.slice(0,D)}),P=R(R({},P),{},{text:P.text.slice(D)})}Object.assign(P,s),G&&a.push(G),a.push(P),X&&a.push(X)}r=a}return r}},jr=e=>e.selection?e.selection:e.children.length>0?S.end(e,[]):[0],m;(function(e){e[e.None=0]="None",e[e.Extend=1]="Extend",e[e.ZWJ=2]="ZWJ",e[e.RI=4]="RI",e[e.Prepend=8]="Prepend",e[e.SpacingMark=16]="SpacingMark",e[e.L=32]="L",e[e.V=64]="V",e[e.T=128]="T",e[e.LV=256]="LV",e[e.LVT=512]="LVT",e[e.ExtPict=1024]="ExtPict",e[e.Any=2048]="Any"})(m||(m={}));m.L,m.L|m.V|m.LV|m.LVT,m.LV|m.V,m.V|m.T,m.LVT|m.T,m.T,m.Any,m.Extend|m.ZWJ,m.Any,m.SpacingMark,m.Prepend,m.Any,m.ZWJ,m.ExtPict,m.RI,m.RI;var kr={delete(e,t){e.delete(t)},insertFragment(e,t,r){e.insertFragment(t,r)},insertText(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};S.withoutNormalizing(e,()=>{var{voids:n=!1}=r,{at:s=jr(e)}=r;if(f.isPath(s)&&(s=S.range(e,s)),d.isRange(s))if(d.isCollapsed(s))s=s.anchor;else{var i=d.end(s);if(!n&&S.void(e,{at:i}))return;var o=d.start(s),a=S.pointRef(e,o),c=S.pointRef(e,i);lt.delete(e,{at:s,voids:n});var l=a.unref(),h=c.unref();s=l||h,lt.setSelection(e,{anchor:s,focus:s})}if(!(!n&&S.void(e,{at:s})||S.elementReadOnly(e,{at:s}))){var{path:g,offset:p}=s;t.length>0&&e.apply({type:"insert_text",path:g,offset:p,text:t})}})}};function ut(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function ce(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ut(Object(r),!0).forEach(function(n){H(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ut(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var lt=ce(ce(ce(ce({},yr),pr),br),kr);const _=nr({}),W=(e,t)=>{const r=e.annotations.filter(s=>{if(e.avFileUuid&&s.file!==e.avFileUuid)return!1;if(e.sets.length>0){const i=e.sets.length===0;if(s.set&&!i&&!e.sets.includes(s.set))return!1}if(e.tags.length>0){let i=!1;for(let o=0;o<s.tags.length;o++){const a=s.tags[o];if(e.tags.find(c=>c.category.toLowerCase()===a.category.toLowerCase()&&c.tag.toLowerCase()===a.tag.toLowerCase())){i=!0;break}}if(!i)return!1}if(e.clip){const i=s.start_time>=e.clip.start&&s.start_time<=e.clip.end,o=s.end_time>=e.clip.start&&s.end_time<=e.clip.end;if(!i&&!o)return!1}if(e.searchQuery){const i=s.annotation.map(o=>u.string(o)).join(`
`).toLowerCase();if(i&&!i.toLowerCase().includes(e.searchQuery.toLowerCase()))return!1}return!0}),n=r.map(s=>({start:s.start_time,end:s.end_time||void 0,playerId:t,uuid:s.uuid}));return{filteredAnnotations:r.map(s=>s.uuid),annotationStarts:n}},Pt=(e,t)=>t.tags.length===0?!1:e.tags.length===0&&t.tags.length>0?!0:t.snapToAnnotations,Nr=(e,t)=>{const r=_.get()[t],n=r.tags||[],s=n?.find(a=>a.category===e.category&&a.tag===e.tag)?n.filter(a=>a.category!==e.category||a.tag!==e.tag):[...n,e],i={...r,tags:s},o=W(i,t);i.filteredAnnotations=o.filteredAnnotations,i.annotationStarts=o.annotationStarts,i.snapToAnnotations=Pt(r,i),_.setKey(t,i)},Rr=(e,t,r)=>{const n=_.get()[r],s=n.tags?.filter(a=>a.category.toLowerCase()===e.toLowerCase())||[];let i;if(s.length===t[e].tags.length)i={...n,tags:n.tags?.filter(a=>a.category.toLowerCase()!==e.toLowerCase())};else{const a=t[e].tags.map(l=>({category:e,tag:l})),c=n.tags?[...n.tags]:[];a.forEach(l=>{c.findIndex(h=>h.category.toLowerCase()===l.category.toLowerCase()&&h.tag.toLowerCase()===l.tag.toLowerCase())===-1&&c.push(l)}),i={...n,tags:c}}const o=W(i,r);i.filteredAnnotations=o.filteredAnnotations,i.annotationStarts=o.annotationStarts,i.snapToAnnotations=Pt(n,i),_.setKey(r,i)},Dr=(e,t)=>{const r=_.get()[t];let n;r.sets.includes(e)?n={...r,sets:r.sets.filter(i=>i!==e)}:n={...r,sets:[...r.sets,e]};const s=W(n,t);n.filteredAnnotations=s.filteredAnnotations,n.annotationStarts=s.annotationStarts,_.setKey(t,n)},Fr=(e,t)=>{const n={..._.get()[t],avFileUuid:e},s=W(n,t);n.filteredAnnotations=s.filteredAnnotations,n.annotationStarts=s.annotationStarts,_.setKey(t,n)},Tr=(e,t)=>{const n={..._.get()[t],searchQuery:e},s=W(n,t);n.filteredAnnotations=s.filteredAnnotations,n.annotationStarts=s.annotationStarts,_.setKey(t,n)},Cr=(e,t)=>{const n={..._.get()[t],[e]:[]},s=W(n,t);n.filteredAnnotations=s.filteredAnnotations,n.annotationStarts=s.annotationStarts,e==="tags"&&(n.snapToAnnotations=!1),_.setKey(t,n)},zr=(e,t)=>{const n={..._.get()[t],clip:e},s=W(n,t);n.filteredAnnotations=s.filteredAnnotations,n.annotationStarts=s.annotationStarts,_.setKey(t,n)};export{_ as $,Rr as a,Nr as b,Cr as c,Fr as d,zr as e,Tr as s,Dr as t};
